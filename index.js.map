{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '54430454-4fc9121801bd2b14b5a193f8d';\n\nexport default async function getImagesByQuery(query, page = 1, perPage = 15) {\n    const response = await axios.get('', {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            page,\n            per_page: Math.max(perPage, 15),\n        },\n    });\n    return response;\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader-box');\nconst loadBtn = document.querySelector('.load-btn');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst createGallery = images => {\n  const galleryMarkup = images\n    .map(\n      image => `<li class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n              <img\n                class=\"gallery-img\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n                loading=\"lazy\"\n              />\n            </a>  \n            <div class=\"img-desc-box\">\n              <p class=\"img-desc\">\n                <span class=\"desc-title\">Likes</span>\n                <span class=\"desc-text\">${image.likes}</span>\n              </p>\n              <p class=\"img-desc\">\n                <span class=\"desc-title\">Views</span>\n                <span class=\"desc-text\">${image.views}</span>\n              </p>\n              <p class=\"img-desc\">\n                <span class=\"desc-title\">Comments</span>\n                <span class=\"desc-text\">${image.comments}</span>\n              </p>\n              <p class=\"img-desc\">\n                <span class=\"desc-title\">Downloads</span>\n                <span class=\"desc-text\">${image.downloads}</span>\n              </p>\n            </div>\n          </li>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  lightbox.refresh();\n};\n\nconst clearGallery = () => {\n  gallery.innerHTML = '';\n};\nconst showLoader = () => {\n  loader.classList.add('is-visible');\n};\nconst hideLoader = () => {\n  loader.classList.remove('is-visible');\n};\nexport default { createGallery, clearGallery, showLoader, hideLoader, showLoadBtn, hideLoadBtn };  \n\nfunction showLoadBtn() {\n  if (!loadBtn) return;\n  loadBtn.classList.add('is-visible');\n}\n\nfunction hideLoadBtn() {\n  if (!loadBtn) return;\n  loadBtn.classList.remove('is-visible');\n}\n\nexport { showLoadBtn, hideLoadBtn };","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport getImagesByQuery from './js/pixabay-api';\nimport renderFunctions from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst loadBtn = document.querySelector('.load-btn');\n\nlet currentPage = 1;\nconst perPage = 15;\nlet currentQuery = '';\nlet totalPages = 0;\n\nform.addEventListener('submit', handleImageSearch);\nloadBtn && loadBtn.addEventListener('click', handleLoadMore);\n\nfunction scrollByGalleryCardHeight() {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (!galleryItem) return;\n  const cardHeight = galleryItem.getBoundingClientRect().height;\n  window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n}\n\nasync function handleImageSearch(event) {\n  event.preventDefault();\n  const inputValue = event.target['search-text'].value.trim();\n\n  if (inputValue === '') {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Please enter your request in the search field!',\n      messageColor: 'black',\n      backgroundColor: 'yellow',\n    });\n    return;\n  }\n\n  currentQuery = inputValue;\n  currentPage = 1;\n\n  renderFunctions.clearGallery();\n  renderFunctions.hideLoadBtn && renderFunctions.hideLoadBtn();\n  renderFunctions.showLoader();\n\n  try {\n    const response = await getImagesByQuery(currentQuery, currentPage, perPage);\n    const images = response.data.hits;\n    const totalHits = response.data.totalHits || 0;\n    totalPages = Math.ceil(totalHits / perPage) || 0;\n\n    if (images.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching<br>your search query. Please try again!',\n        messageColor: '#ffffff',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n      });\n      renderFunctions.hideLoadBtn && renderFunctions.hideLoadBtn();\n      return;\n    }\n\n    renderFunctions.createGallery(images);\n\n    if (currentPage >= totalPages) {\n      renderFunctions.hideLoadBtn && renderFunctions.hideLoadBtn();\n      iziToast.warning({ message: \"We're sorry, but you've reached the end of search results.\", position: 'topRight' });\n    } else {\n      renderFunctions.showLoadBtn && renderFunctions.showLoadBtn();\n      scrollByGalleryCardHeight();\n    }\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Something went wrong...',\n      messageColor: 'black',\n      backgroundColor: 'yellow',\n      closeOnClick: true,\n    });\n  } finally {\n    renderFunctions.hideLoader();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  if (!currentQuery) return;\n  currentPage += 1;\n  renderFunctions.hideLoadBtn && renderFunctions.hideLoadBtn();\n  renderFunctions.showLoader();\n  try {\n    const response = await getImagesByQuery(currentQuery, currentPage, perPage);\n    const images = response.data.hits;\n    const totalHits = response.data.totalHits || 0;\n    totalPages = Math.ceil(totalHits / perPage) || 0;\n\n    renderFunctions.createGallery(images);\n\n    if (currentPage >= totalPages) {\n      renderFunctions.hideLoadBtn && renderFunctions.hideLoadBtn();\n      iziToast.warning({ message: \"We're sorry, but you've reached the end of search results.\", position: 'topRight' });\n    } else {\n      renderFunctions.showLoadBtn && renderFunctions.showLoadBtn();\n    }\n\n    scrollByGalleryCardHeight();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Something went wrong...',\n      messageColor: 'black',\n      backgroundColor: 'yellow',\n      closeOnClick: true,\n    });\n  } finally {\n    renderFunctions.hideLoader();\n  }\n}"],"names":["axios","API_KEY","getImagesByQuery","query","page","perPage","gallery","loader","loadBtn","lightbox","SimpleLightbox","createGallery","images","galleryMarkup","image","clearGallery","showLoader","hideLoader","renderFunctions","showLoadBtn","hideLoadBtn","form","currentPage","currentQuery","totalPages","handleImageSearch","handleLoadMore","scrollByGalleryCardHeight","galleryItem","cardHeight","event","inputValue","iziToast","response","totalHits"],"mappings":"+vBAEAA,EAAM,SAAS,QAAU,2BACzB,MAAMC,EAAU,qCAED,eAAeC,EAAiBC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAY1E,OAXiB,MAAML,EAAM,IAAI,GAAI,CACjC,OAAQ,CACJ,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,KAAK,IAAIC,EAAS,EAAE,CACjC,CACT,CAAK,CAEL,CCfA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,aAAa,EAC7CC,EAAU,SAAS,cAAc,WAAW,EAE5CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAgBC,GAAU,CAC9B,MAAMC,EAAgBD,EACnB,IACCE,GAAS;AAAA,uBACQA,EAAM,aAAa;AAAA;AAAA;AAAA,uBAGnBA,EAAM,YAAY;AAAA,uBAClBA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAOSA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,0CAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,0CAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,0CAIdA,EAAM,SAAS;AAAA;AAAA;AAAA,gBAIpD,EACA,KAAK,EAAE,EACVR,EAAQ,mBAAmB,YAAaO,CAAa,EAErDJ,EAAS,QAAO,CAClB,EAEMM,EAAe,IAAM,CACzBT,EAAQ,UAAY,EACtB,EACMU,EAAa,IAAM,CACvBT,EAAO,UAAU,IAAI,YAAY,CACnC,EACMU,EAAa,IAAM,CACvBV,EAAO,UAAU,OAAO,YAAY,CACtC,EACAW,EAAe,CAAE,cAAAP,EAAe,aAAAI,EAAc,WAAAC,EAAY,WAAAC,EAAY,YAAAE,EAAa,YAAAC,GAEnF,SAASD,GAAc,CAChBX,GACLA,EAAQ,UAAU,IAAI,YAAY,CACpC,CAEA,SAASY,GAAc,CAChBZ,GACLA,EAAQ,UAAU,OAAO,YAAY,CACvC,CC/DA,MAAMa,EAAO,SAAS,cAAc,OAAO,EACrCb,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIc,EAAc,EAClB,MAAMjB,EAAU,GAChB,IAAIkB,EAAe,GACfC,EAAa,EAEjBH,EAAK,iBAAiB,SAAUI,CAAiB,EACjDjB,GAAWA,EAAQ,iBAAiB,QAASkB,CAAc,EAE3D,SAASC,GAA4B,CACnC,MAAMC,EAAc,SAAS,cAAc,eAAe,EAC1D,GAAI,CAACA,EAAa,OAClB,MAAMC,EAAaD,EAAY,sBAAqB,EAAG,OACvD,OAAO,SAAS,CAAE,IAAKC,EAAa,EAAG,SAAU,QAAQ,CAAE,CAC7D,CAEA,eAAeJ,EAAkBK,EAAO,CACtCA,EAAM,eAAc,EACpB,MAAMC,EAAaD,EAAM,OAAO,aAAa,EAAE,MAAM,OAErD,GAAIC,IAAe,GAAI,CACrBC,EAAS,MAAM,CACb,SAAU,WACV,QAAS,iDACT,aAAc,QACd,gBAAiB,QACvB,CAAK,EACD,MACD,CAEDT,EAAeQ,EACfT,EAAc,EAEdJ,EAAgB,aAAY,EAC5BA,EAAgB,aAAeA,EAAgB,cAC/CA,EAAgB,WAAU,EAE1B,GAAI,CACF,MAAMe,EAAW,MAAM/B,EAAiBqB,EAAcD,EAAajB,CAAO,EACpEO,EAASqB,EAAS,KAAK,KACvBC,EAAYD,EAAS,KAAK,WAAa,EAG7C,GAFAT,EAAa,KAAK,KAAKU,EAAY7B,CAAO,GAAK,EAE3CO,EAAO,SAAW,EAAG,CACvBoB,EAAS,MAAM,CACb,QACE,8EACF,aAAc,UACd,gBAAiB,UACjB,SAAU,UAClB,CAAO,EACDd,EAAgB,aAAeA,EAAgB,cAC/C,MACD,CAEDA,EAAgB,cAAcN,CAAM,EAEhCU,GAAeE,GACjBN,EAAgB,aAAeA,EAAgB,cAC/Cc,EAAS,QAAQ,CAAE,QAAS,6DAA8D,SAAU,UAAU,CAAE,IAEhHd,EAAgB,aAAeA,EAAgB,cAC/CS,IAEH,MAAe,CACdK,EAAS,MAAM,CACb,SAAU,WACV,QAAS,0BACT,aAAc,QACd,gBAAiB,SACjB,aAAc,EACpB,CAAK,CACL,QAAY,CACRd,EAAgB,WAAU,EAC1BG,EAAK,MAAK,CACX,CACH,CAEA,eAAeK,GAAiB,CAC9B,GAAKH,EACL,CAAAD,GAAe,EACfJ,EAAgB,aAAeA,EAAgB,cAC/CA,EAAgB,WAAU,EAC1B,GAAI,CACF,MAAMe,EAAW,MAAM/B,EAAiBqB,EAAcD,EAAajB,CAAO,EACpEO,EAASqB,EAAS,KAAK,KACvBC,EAAYD,EAAS,KAAK,WAAa,EAC7CT,EAAa,KAAK,KAAKU,EAAY7B,CAAO,GAAK,EAE/Ca,EAAgB,cAAcN,CAAM,EAEhCU,GAAeE,GACjBN,EAAgB,aAAeA,EAAgB,cAC/Cc,EAAS,QAAQ,CAAE,QAAS,6DAA8D,SAAU,UAAU,CAAE,GAEhHd,EAAgB,aAAeA,EAAgB,cAGjDS,GACD,MAAe,CACdK,EAAS,MAAM,CACb,SAAU,WACV,QAAS,0BACT,aAAc,QACd,gBAAiB,SACjB,aAAc,EACpB,CAAK,CACL,QAAY,CACRd,EAAgB,WAAU,CAC3B,EACH"}